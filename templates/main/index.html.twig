{% extends 'base.html.twig' %}

{% block title %}Bienvenue sur Snowtricks!{% endblock %}

{% block content %}
    <div class="banner">
        <img src="{{ asset ('img/snowtricksAccueil.jpg') }}" class="img-accueil img-fluid">
        <p style="text-shadow: #FFF 2px 0 10px;bottom:10rem;left:1rem;font-size:4rem;" class="position-absolute">Bienvenue sur Snowtricks</p>
        <p class="position-absolute" style="bottom:2.6rem;right:1rem;font-size:5rem;">
        <a href="#trick-section" style="color:black;">
            <i class="bi bi-arrow-down-circle-fill"></i>
        </a>
        </p>
    </div>
    <div class="banner-mobil">
        <img src="{{ asset ('img/snowtricksAccueil.jpg') }}" class="img-fluid">
        <p style="text-shadow: #FFF 2px 0 10px;bottom:7rem;left:0.2rem;font-size:1.5rem;" class="position-relative">Bienvenue sur Snowtricks</p>
        <p class="position-relative" style="bottom:6rem;left:22rem;font-size:1.5rem;">
        <a href="#trick-section" style="color:black;">
            <i class="bi bi-arrow-down-circle-fill"></i>
        </a>
        </p>
    </div>
    <div class="container">
    {% for message in app.flashes('success') %}
      <div class="alert alert-success">
        {{ message }}
      </div>
    {% endfor %}
    {#<div id="main-content" class="row justify-content-around text-center">
        {% for trick in tricks %}
                    <div class="col-12 col-lg-3 my-3 mx-3 mb-3">
                        <div class="card">
                            <a href="{{ path('show-trick', {group:trick.groupTrick.slug, slug:trick.slug}) }}" class="text-decoration-none" style="color:black;">
                                <img src="{{ asset ('uploads/pictures/' ~ trick.pictures[0].fileName) }}" class="card-img-top card-img-trick" alt="{{ trick.name }}">
                                <div class="card-body">
                                    <div class="card-footer">
                                        <h4 class="card-title">{{ trick.name }}</h4>
                        
                                        {% if is_granted('ROLE_USER') %}

                                            <a href="{{ path('edit-trick', {slug:trick.slug}) }}" class="text-decoration-none" style="color:black;">
                                                <i class="bi bi-pencil-fill"></i>
                                            </a>
                                            <a href={#"#eraseTrick" data-bs-toggle="modal" data-trick=#}"{#{{ path('delete-trick', {id:trick.id}) }}" class="trick-delete text-decoration-none" style="color:red;">
                                                <i class="bi bi-trash-fill"></i>
                                            </a>
                                        {% endif %}
                                    </div>
                                </div>
                            </a>
                        </div>
                    </div>
        {% endfor %}
        <div class="load-more-block mt-3">
			<button type="button" class="btn btn-primary text-white" id="load-more">
				<i class="bi bi-plus-circle-dotted rounded-5"></i><a href="{{ path('load-more') }}">Load More</a></button>
                
		</div>
    </div>#}

		<div id="trick-section" data-bs-spy="scroll" data-bs-offset="0" tabindex="0"></div>
		<div class="row" id="tricks">
			{{ include ('trick/tricks-list.html.twig') }}
		</div>
		<div class="mt-3">
			<button type="button" class="btn btn-primary" id="load-more">
				<i class="bi bi-plus-circle-dotted load-circle"></i>Load More</button>
		</div>
		<div class=" mb-3">
			<a href="#trick-section" class="scrollable">
				<i class="bi bi-arrow-up-square-fill"></i>
			</a>
		</div>

        <!-- Modal -->
	<div class="modal fade" id="eraseTrick" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title" id="exampleModalLabel">
						<span class="badge bg-danger">Attention</span>
					</h5>
					<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
				</div>
				<div class="modal-body">
					<p>Etes vous certain de vouloir effacer ce trick ?</p>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Diantre non !</button>
					<button id="trick-delete" type="button" class="btn btn-primary">Parfaitement !</button>
				</div>
			</div>
		</div>
	</div>

    </div>

{% block javascripts %}
{#<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>#}
	{{parent()}}
	<script>
		$(function () {
var click_count = 9
$('#load-more').off('click').on('click', function (event) {
    /* event.preventDefault();
    event.stopPropagation(); */
    console.log('load-more***********************')
$.ajax({
url:'{{ path('load-more') }}' + '/' + click_count,
method: 'get'
}).done(function (message) {

$('#tricks').append(message)
})
click_count += 3
if (click_count >= {{ trickCount }}) {
$('#load-more').hide()
}
})

$('#trick-delete').click(function () {
let trick_url = $(this).data('trick');
console.log(trick_url)
$.ajax({url: trick_url, method: 'get'}).done(function () { // Redirect to home page
window.location.replace("{{ path('home') }}");
})
})
$('.trick-delete').click(function () {
let id = $(this).data('trick');
$('#trick-delete').data('trick', id)
})
})

	</script>
    
{% endblock %}
{% endblock %}
